---
import Layout from "@/layouts/Layout.astro";
import AdminLoginForm from "@/components/auth/AdminLoginForm.vue";
import { auth } from "@/lib/auth";

// Si ya est√° autenticado como admin, redirigir al dashboard
const session = await auth.api.getSession({
	headers: Astro.request.headers,
});

if (session && (session.user as any).role === "admin") {
	return Astro.redirect("/admin/dashboard");
}

let error = "";
---

<Layout title="Admin Login">
	<section
		class="py-24 md:py-32 bg-secondary flex items-center justify-center p-4"
	>
		<div class="w-full max-w-md">
			<div class="text-center mb-12">
				<div
					class="w-16 h-16 bg-primary rounded-2xl flex items-center justify-center text-white font-black text-2xl italic mx-auto mb-6 shadow-2xl shadow-primary/40"
				>
					CB
				</div>
				<h1
					class="text-white text-3xl font-black uppercase tracking-tighter"
				>
					Admin <span class="text-primary italic">Access</span>
				</h1>
			</div>

			<AdminLoginForm error={error} client:load />

			<div class="mt-12 text-center">
				<a
					href="/"
					class="text-white/20 text-xs font-bold uppercase tracking-widest hover:text-white transition-colors flex items-center justify-center gap-2"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="14"
						height="14"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="3"
						stroke-linecap="round"
						stroke-linejoin="round"
						><path d="m15 18-6-6 6-6"></path></svg
					>
					Volver a la web
				</a>
			</div>
		</div>
	</section>
</Layout>

<style>
	/* Override AuthForm styles for dark theme if needed, but keeping it simple for now */
</style>
